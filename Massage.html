<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
    <button onclick="back()">back</button>
    <center>
       
        <p class="" style="font-family: fantasy;">Your Ticket</p>
        <div>
            <div id="detaila" class="costom" style="height: 500px; width: 500px; position: absolute; display: none;" >
                <table id="tbl11">
                    <tr><th>No</th><th>Tikcket_Id</th><th>Catagory</th><th>Time</th> </tr>
                   
    
                </table>
                <h4>Responce</h4>
                <div class="costom" style="width: 90%;"><p id="showMessagea">massage</p></div><br>
                <button onclick="sendResponsea()">next</button>
                <!-- <div><h4>Riply</h4><textarea name="" id="responce" cols="60" rows="4"></textarea><button>next</button></div> -->
            </div>
            <div id="ticketa" class="costom" style=" height: max-content;">
                <table id="tbl22">
                    <tr><th>No</th><th>Tikcket_Id</th><th>Catagory</th><th>Time</th><th>click</th> </tr>
                   
                </table>
                <button onclick="move()">add ticket</button>
            </div>
        </div>
    </center>
    
</body>
<script>
let tab11;
let tab22;//let response;
const UserI=localStorage.getItem('u');
tab11 = document.getElementById("tbl11");
tab22 = document.getElementById("tbl22");
var rowsa = tab22.getElementsByTagName('tr');
let detaila = document.getElementById("detaila");
let showMessagea = document.getElementById('showMessagea');
//response = document.getElementById('response');
let ticketa=document.getElementById('ticketa');

function move(){
    window.location.href="frrdback.html"
}

// Retrieving data in another HTML file
// let hash = localStorage.getItem('map');

// console.log(hash);

//data....
// let hash=new Map();
// hash.set("cost1@gmail.com",{i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''});
// hash.set("cost2@gmail.com",{i:12344,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''});
// hash.set("cost3@gmail.com",{i:12335,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''});
// hash.set("cost4@gmail.com",{i:12545,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''});
// hash.set("cost5@gmail.com",{i:12645,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''});
let mapJson = sessionStorage.getItem('myMapData');

// Parse JSON string into an array of key-value pairs
let mapArray = JSON.parse(mapJson);

// Create a Map from the array
let hash = new Map(mapArray);

const arra=hash.get(UserI);

// const arra=[{i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''},
//             {i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''},
//             {i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''},
//             {i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''},
//             {i:12345,c:"quary",d:"12", m:"dsdfgf dfgdf",r:''}]

//.......            


for (const valuea of arra) {
    let row2 = tab22.insertRow(1);
    let cell1 = row2.insertCell(0);
    let cell2 = row2.insertCell(1);
    let cell3 = row2.insertCell(2);
    let cell4 = row2.insertCell(3);
    let cell5 = row2.insertCell(4);
   // let cell6 = row2.insertCell(5);
  //  let input = document.createElement("input");
   // input.type = "checkbox";

    let button = document.createElement("button");
    button.innerHTML = "view";
    button.onclick = function () {
        let rowIndex = this.parentNode.parentNode.rowIndex;
        // Call the view function with the rowIndex
        viewTicketa(rowIndex);
    };

    cell1.innerHTML = arra.indexOf(valuea)+1;
    cell2.innerHTML = valuea.i;
    //cell3.innerHTML = key;
    cell3.innerHTML = valuea.c;
    cell4.innerHTML = valuea.d;
    cell5.appendChild(button);
    // cell2.innerHTML=value.c;
}

let currentKeya;
let currentValuea;

function viewTicketa(rowIndex) {
    currentKeya = rowsa[rowIndex].getElementsByTagName('td')[0].innerText;
    detaila.style.display = "block";

    currentValuea = arra[currentKeya-1];
    let row1 = tab11.insertRow(1);
    let cell1 = row1.insertCell(0);
    let cell2 = row1.insertCell(1);
    let cell3 = row1.insertCell(2);
    let cell4 = row1.insertCell(3);
   // let cell5 = row1.insertCell(4);
   // let input = document.createElement("input");
  //  input.type = "checkbox";

   // cell1.appendChild(input);
    cell1.innerHTML = rowsa[rowIndex].getElementsByTagName('td')[0].innerText;
    cell2.innerHTML = rowsa[rowIndex].getElementsByTagName('td')[1].innerText;
    cell3.innerHTML = rowsa[rowIndex].getElementsByTagName('td')[2].innerText;
    cell4.innerHTML = rowsa[rowIndex].getElementsByTagName('td')[3].innerText;
    showMessagea.innerText = currentValuea.m;
   // response.value = currentValuea.r;
    ticketa.style.display="none";
}

function sendResponsea() {
    //      hash.set(currentKeya, {
    //     i: currentValuea.i,
    //     c: currentValuea.c,
    //     d: currentValuea.d,
    //     m: currentValuea.m,
    //     r: response.value
    // });
    detaila.style.display = "none";
    //response.value = "";
    currentKeya = null;
    currentValuea = null;
    tab11.deleteRow(1);
    ticketa.style.display="block"
}

function back(){
    window.location.href="index.html"
}


   </script>
</html>